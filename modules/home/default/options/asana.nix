# programs.asana.enable = true;
{
  config,
  lib,
  pkgs,
  ...
}: let
  cfg = config.programs.asana;
  inherit (lib) mkIf mkOption options types;
  inherit (config.programs.chromium.lib) mkClass mkWebApp;
in {
  options.programs.asana = {
    enable = options.mkEnableOption "asana";
    url = mkOption {
      type = types.str;
      default = "https://app.asana.com/";
    };
    profile = mkOption {
      type = with lib.types; nullOr str;
      default = "work";
    };
  };

  config = mkIf cfg.enable {
    services.keyd.windows = {
      "${mkClass cfg.url}" = {
        "super.[" = "A-left"; # back
        "super.]" = "A-right"; # forward
      };
    };
    xdg.desktopEntries = mkWebApp {
      name = "Asana";
      inherit (cfg) url profile;
      icon =
        pkgs.writeText "icon.svg"
        # html
        ''
          <svg xmlns="http://www.w3.org/2000/svg" width="1529" height="1410"><path fill="#F06A6A" d="m1342 779 2.76 1.35c14.061 6.954 27.314 14.768 40.24 23.65l2.043 1.4c11.434 7.88 22.002 16.593 32.172 26.034a270.121 270.121 0 0 0 7.035 6.254c6.105 5.308 11.66 11.072 16.922 17.21a169.043 169.043 0 0 0 3.844 4.266c47.659 51.26 74.561 121.925 80.984 190.836l.214 2.208c7.581 81.629-18.868 165.598-69.214 229.792l-2.172 2.816c-4.248 5.429-8.794 10.535-13.465 15.602a239.734 239.734 0 0 0-5.738 6.52c-7.28 8.34-15.163 15.981-23.86 22.832a178.71 178.71 0 0 0-6.55 5.578c-56.311 49.501-135.513 74.938-209.652 74.84l-2.546-.002c-13.104-.026-26.017-.417-39.017-2.186l-2.877-.375c-34.661-4.627-67.51-14.836-99.123-29.625l-2.67-1.242c-19.852-9.315-38.516-20.612-55.602-34.368a396.918 396.918 0 0 0-4.642-3.663c-5.104-3.998-9.952-8.226-14.738-12.598a226.33 226.33 0 0 0-6.035-5.254c-9.473-8.279-18.439-17.337-26.22-27.223-2.23-2.825-4.562-5.544-6.905-8.277-53.927-64.779-78.09-152.765-71.419-236.106C870.588 997.375 886.932 946.093 915 902l1.898-3.02C930.563 877.908 946.692 859.122 964 841l2.719-2.848c5.738-5.874 11.859-11.046 18.281-16.152 1.1-.91 2.197-1.824 3.293-2.738 76.963-63.71 182.558-86.554 353.707-40.262ZM319.208 745.938c50.224-.83 100.488 6.886 146.437 27.981a549.905 549.905 0 0 0 6.695 3.007C516.119 796.598 558.5 829.003 588 867c.924 1.126 1.851 2.25 2.781 3.371C603.254 885.492 613.48 901.897 623 919l1.272 2.25c26.6 47.25 38.941 102.304 38.978 156.25l.002 2.727c-.077 64.847-19.272 131.71-57.252 184.773l-2.387 3.43c-5.223 7.469-10.749 14.589-16.613 21.57l-2.234 2.797c-6.16 7.572-12.886 14.538-19.766 21.453l-2.768 2.796c-6.106 6.078-12.506 11.579-19.232 16.954-1.815 1.56-3.628 3.121-5.437 4.688C522.845 1350.92 506.757 1360.84 490 1370l-4.094 2.277c-37.94 20.918-81.857 33.05-124.906 36.723l-3.375.336c-87.476 7.492-174.59-21.88-241.428-78.158-4.771-4.067-9.411-8.218-13.76-12.74-1.63-1.68-1.63-1.68-4.437-3.875-3.09-2.64-5.596-5.45-8.223-8.536-1.646-1.877-3.354-3.608-5.152-5.34-4.618-4.556-8.601-9.608-12.625-14.687l-2.445-3.07C63.24 1274.918 57.469 1266.608 52 1258l-1.398-2.197C23.458 1212.747 6.753 1164.555 1 1114l-.29-2.445c-1.117-11.016-.954-22.12-.96-33.18l-.002-3.324C-.236 1058.819.23 1043.028 3 1027l.504-3.117c10.708-65.447 41.714-130.474 89.613-177a56.568 56.568 0 0 0 4.446-5.008c2.525-2.98 5.199-5.392 8.167-7.914 2.467-2.131 4.83-4.356 7.208-6.586C125.57 815.89 139.63 806.172 154 797l1.88-1.201c48.33-30.586 106.043-48.754 163.328-49.861ZM774 0l2.212.038C849.799 1.531 922.957 29.421 979 77l3.04 2.48c7.644 6.303 14.748 13.098 21.773 20.082.87.863 1.742 1.725 2.64 2.613 5.938 5.967 11.307 12.241 16.547 18.825 1.048 1.278 2.099 2.554 3.152 3.828 6.854 8.384 13.041 17.035 18.848 26.172l2.047 3.2c33.915 54.06 51.118 115.042 51.265 178.8l.012 2.697c.039 17.992-1.388 35.761-4.512 53.49l-.647 3.688c-11.196 61.272-40.156 118.97-82.673 164.445-2.282 2.455-4.487 4.958-6.68 7.492-2.992 3.38-6.134 6.359-9.582 9.266-2.634 2.27-5.139 4.66-7.668 7.047C979.163 587.998 971.112 594 963 600l-1.885 1.404C952.41 607.867 943.418 613.633 934 619l-2.438 1.399C917.775 628.266 903.739 635.1 889 641l-2.93 1.175C860.656 652.2 834.061 658.487 807 662l-2.476.35c-28.33 3.945-58.305 2.698-86.524-1.35l-2.878-.406C661.144 652.656 609.26 630.017 566 597l-1.76-1.322c-9.066-6.82-17.347-14.28-25.56-22.099-2.303-2.165-4.677-4.246-7.055-6.329-4.938-4.426-9.288-9.241-13.625-14.25-.912-1.027-1.825-2.053-2.738-3.078C491.037 522.483 471.018 490.229 458 456l-1.088-2.804c-7.983-20.703-13.724-41.75-17.724-63.571l-.591-3.197c-3.164-18.295-3.977-36.58-3.91-55.115l.006-3.185c.046-15.908.6-31.42 3.307-47.128l.52-3.186c2.645-15.97 6.487-31.421 11.48-46.814l1.05-3.271C461.944 194.245 478.064 163.307 499 135l1.352-1.832c4.819-6.49 9.857-12.718 15.347-18.656a262.135 262.135 0 0 0 5.461-6.184C531.701 96.253 543.29 84.772 556 75a571.703 571.703 0 0 0 3.184-2.664C575.306 58.866 593.34 47.608 612 38l2.902-1.506C656.074 15.325 701.77 2.528 748.125.438L750.92.31C758.62-.017 766.293-.171 774 0Z"/></svg>
        '';
    };
  };
}
